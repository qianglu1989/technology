>爱生活，爱编码，微信搜一搜【架构技术专栏】关注这个喜欢分享的地方。
>本文 [架构技术专栏](http://47.104.79.116:4321/)  已收录，有各种视频、资料以及技术文章。

## 一、概述

分布式、微服务、Service Mesh目前都是大家耳熟能详的词语了，现在随便一个互联网公司说出来大家都是在搞微服务。

但我们搞来搞去，怎么样来衡量一个应用当前的状态到底是怎么样的？到底需不需要扩容？是需要横向扩容还是进行项目重构？

这时候我们就需要一堆监控指标来协助我们进行分析当前的应用状态，以便在某些事故发生前进行资源上的调配或优化。

下面咱们就来说道说道这几个重要的指标，一定要记牢，不管面试还是自己用都是必须滴。

 要牢记一点，所有的指标都是根据时间单位来算的，比如每秒XX、每分钟XX，要记住这个大前提，下面咱们都按秒来算。



## 二、指标

#### 1、QPS（Queries Per Second）

概念：服务器每秒处理查询次数，是一台服务器每秒能够处理的查询次数。用户发起查询请求到服务器做出响应这算一次，一秒内用户完成了50次查询请求，那此时服务器QPS就是50。



#### 2、TPS （Transactions Per Second）

概念：服务器每秒处理的事务数，一个事物是用户发起查询请求到服务器做出响应这算一次。纳尼？这难道不是QPS的概念吗？**划重点，这里就要说清楚一个概念了，在针对单接口，TPS可以认为是等价于QPS的，如访问 ‘order.html’ 这个页面而言,是一个TPS。而访问 ‘order.html’  页面可能请求了3此服务器（如调用了css、js、order接口），这实际就算产生了三个QPS**

所以，总结下就是，在针对单接口的时候TPS = QPS ,否则QPS就要看实际的请求次数了。



#### 2、RT（Res（onse Time）

概念：响应实际，就是从客户端请求发起到服务器响应结果的时间。RT这个参数是系统最重要的指标之一，它的大小直接反应了当前系统的响应状态。基本和咱们用户体验息息相关，现在好一点监控系统一般都有三个RT，即平均、最大、最小。

一般系统RT 100ms 以内是比较正常的，300ms 勉强可以接受，1s的话再加上一些其他的外因，给用户的体验就是实实在在的不爽了。



#### 3、并发数

概念：系统能同时处理的请求的数量，很多人经常会把并发数和TPS理解混淆。举例，请求一个index.html 页面，客户端发起了三个请求（css、js、index接口）,那么此时TPS =1 、QPS =3 、并发数 3。

SO，计算公式 ： QPS=并发数/RT  ||  并发数=QPS*RT





#### 4、吞吐量（Throughput）

概念：每秒承受的用户访问量，吞吐量（系统能承受多少压力）和当前请求对CPU消耗、内存、IO使用等等紧密相关。单个请求消耗越高，系统吞吐量越低，反之越高。

一个系统的吞吐量和其TPS 、QPS、并发数息息相关，每个系统针对这些值都有一个相对极限值，只要其中某一个达到最大，系统的吞吐量也就到达极限了。如此时压力继续增大，系统的吞吐量反而会下降，原因是系统超负荷工作，各种资源切换等等的消耗导致系统性能下降。

关系：

所以，理解上面几个关系后，就可以推算出：

QPS（TPS）= 并发数/平均响应时间



#### 5、PV（Page View）

概念： 即每个页面的浏览次数，用户每次刷新就算一次。



#### 6、UV（Unique Visitor）

概念：独立访客数，每天访问的用户数，此数据需要根据用户唯一标识进行去重。



#### 7、Load（系统负载）

概念：此数据指的是Linux系统的负载情况，也就是咱们平时所用Top命令时，最上面显示的数据信息( load average: 0.1, 0.2, 0.5)。此时会显示1分钟、5分钟、15分钟的系统平均Load，很显然load average 的值越低，你的系统负荷越小。

简单的说下这个值应该怎么看，如果你是单核cpu,那此值为1的时候就是系统已经满负荷状态了，需要你马上去解决。但实际经验告诉我们，当系统负荷持续大于0.7的时候（也就是70%），就需要你马上来解决问题了，防止进一步恶化。

为什么需要三个值 load average: 0.1, 0.2, 0.5，其实就是给你个参考。比如只有1分钟的是1，其他俩都是0.1，这表明只是临时突发的现象，问题不大。如果15分钟内，系统负荷都是1或大于1，那表明问题持续存在啊。所以你应该主要观察15分钟的系统负荷。




## 三、结束

好了，简单又开心的概念说完了。可以继续进行我的王者大业了，荣耀王者在等待着我。


>爱生活，爱编码，微信搜一搜【架构技术专栏】关注这个喜欢分享的地方。
>本文 [架构技术专栏](http://47.104.79.116:4321/)  已收录，有各种视频、资料以及技术文章。